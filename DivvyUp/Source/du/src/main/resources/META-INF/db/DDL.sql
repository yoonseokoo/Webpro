

--DROPPING QUERY'S
DROP TABLE MEMBER CASCADE CONSTRAINTS;
DROP SEQUENCE GROUPS_SEQ;
DROP TABLE GROUPS CASCADE CONSTRAINTS;
DROP SEQUENCE GROUPDETAIL_SEQ;
DROP TABLE GROUPDETAIL CASCADE CONSTRAINTS;
DROP SEQUENCE EVENT_SEQ;
DROP TABLE EVENT CASCADE CONSTRAINTS;
DROP SEQUENCE EVENTDETAIL_SEQ;
DROP TABLE EVENTDETAIL CASCADE CONSTRAINTS;
DROP SEQUENCE EVENTHISTORY_SEQ;
DROP TABLE EVENTHISTORY CASCADE CONSTRAINTS;


--SELECT QUERYS

SELECT * FROM  MEMBER;
SELECT * FROM  GROUPS;
SELECT * FROM  GROUPDETAIL;
SELECT * FROM  EVENT;
SELECT * FROM  EVENTDETAIL;
SELECT * FROM  EVENTHISTORY;


-- [1] MEMBER TABLE --
DROP TABLE MEMBER CASCADE CONSTRAINTS;

CREATE TABLE MEMBER(
    MID VARCHAR2(100) PRIMARY KEY,
    MPW VARCHAR2(100) NOT NULL,
    MNAME VARCHAR2(100) NOT NULL,
    MEMAIL VARCHAR2(100) NOT NULL,
    MRDATE DATE DEFAULT SYSDATE NOT NULL);
        
COMMIT;

--[2] GROUPS TABLE --

DROP SEQUENCE GROUPS_SEQ;

CREATE SEQUENCE GROUPS_SEQ MAXVALUE 99999999 NOCYCLE NOCACHE;

DROP TABLE GROUPS CASCADE CONSTRAINTS;

CREATE TABLE GROUPS(
    GID NUMBER(6) PRIMARY KEY,
    GNAME VARCHAR2(100),
    GRDATE DATE DEFAULT SYSDATE,
    GIMG VARCHAR2(100),
    GCONTENT VARCHAR2(4000),
    MID VARCHAR2(100) REFERENCES MEMBER(MID)); -- �׷� ���� ����� ID
  
COMMIT;       

-- [3] GROUP DETAIL -- 

DROP SEQUENCE GROUPDETAIL_SEQ;

CREATE SEQUENCE GROUPDETAIL_SEQ MAXVALUE 99999999 NOCYCLE NOCACHE;
    
DROP TABLE GROUPDETAIL;

CREATE TABLE GROUPDETAIL( -- info about the members in the group
    GDID NUMBER(6) PRIMARY KEY, -- The member's unique ID WITHIN THE GROUP
    GID NUMBER(6) REFERENCES GROUPS(GID), -- group ID to distinguish the groups
    MID VARCHAR2(100) REFERENCES MEMBER(MID), -- member ID to link member's information
    GDBALANCE NUMBER(15) DEFAULT 0,
    GDRDATE DATE DEFAULT SYSDATE); -- date member joined the group

COMMIT;

-- [4] EVENT -- 

DROP SEQUENCE EVENT_SEQ;

CREATE SEQUENCE EVENT_SEQ MAXVALUE 99999999 NOCYCLE NOCACHE;

DROP TABLE EVENT CASCADE CONSTRAINTS;

CREATE TABLE EVENT(
    EID NUMBER(6) PRIMARY KEY,
    ENAME VARCHAR2(100) NOT NULL, --title for payment
    ECONTENT VARCHAR(4000), -- description of payment: eg. taxi cost, dinner...
    EIMAGE VARCHAR2(100), -- image attached relating to payment : eg. receit
    EAMOUNT NUMBER(15) NOT NULL,--total amount paid
    EADDRESS VARCHAR(300),
    ECOUNT NUMBER(3) NOT NULL, --total number of people in the group
    ERDATE DATE DEFAULT SYSDATE, --date of payment
    MID VARCHAR2(100) REFERENCES MEMBER(MID) NOT NULL, --person who paid
    GID NUMBER(6) REFERENCES GROUPS(GID) NOT NULL); -- the group in which the payment was made in

COMMIT;

-- [5] EVENT DETAIL --

DROP SEQUENCE EVENTDETAIL_SEQ; --EVENT �� ������ MEMBER �� SHARE

CREATE SEQUENCE EVENTDETAIL_SEQ MAXVALUE 99999999 NOCYCLE NOCACHE;

DROP TABLE EVENTDETAIL CASCADE CONSTRAINTS; 

CREATE TABLE EVENTDETAIL(
    EDID NUMBER(6) PRIMARY KEY, -- The member's unique ID WITHIN THE PAYMENT
    EID NUMBER(6) REFERENCES EVENT(EID) NOT NULL, -- which payment the member is involved in
    MID VARCHAR2(100)   REFERENCES MEMBER(MID) NOT NULL, --member that was involved in this payment
    EDSHARE NUMBER(10) NOT NULL); -- (the share) amount the member has to pay (calculate using inner join)

COMMIT;

-- [6] EVENTHISTORY--

DROP SEQUENCE EVENTHISTORY_SEQ;

CREATE SEQUENCE EVENTHISTORY_SEQ MAXVALUE 99999999 NOCYCLE NOCACHE;

DROP TABLE EVENTHISTORY;

CREATE TABLE EVENTHISTORY (
    EHID NUMBER(6) PRIMARY KEY,
    EID NUMBER(6) REFERENCES EVENT(EID) NOT NULL,
    MID VARCHAR2(100)  REFERENCES MEMBER(MID) NOT NULL,
    EDSHARE NUMBER(10),
    ERDATE DATE NOT NULL,
    ENAME VARCHAR2(100) NOT NULL);
    
COMMIT;

-- [7] CENTRALSYSTEM

DROP SEQUENCE CENTRALSYSTEM_SEQ;

CREATE SEQUENCE CENTRALSYSTEM_SEQ MAXVALUE 99999999 NOCYCLE NOCACHE;

DROP TABLE CENTRALSYSTEM;

CREATE TABLE CENTRALSYSTEM (
    CSID NUMBER(6) PRIMARY KEY,
    CSAMOUNT NUMBER(15) DEFAULT 0 NOT NULL,  --temporary varaible that continous to change
    CSALLPAID NUMBER(1) DEFAULT 0 NOT NULL,
    GID NUMBER(6) REFERENCES GROUPS(GID) NOT NULL);

SELECT * FROM CENTRALSYSTEM;

COMMIT;
